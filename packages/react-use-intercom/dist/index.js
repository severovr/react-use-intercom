import*as n from'react';var ce=Object.defineProperty;var R=Object.getOwnPropertySymbols;var Q=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var G=(e,o,s)=>o in e?ce(e,o,{enumerable:true,configurable:true,writable:true,value:s}):e[o]=s,u=(e,o)=>{for(var s in o||(o={}))Q.call(o,s)&&G(e,s,o[s]);if(R)for(var s of R(o))X.call(o,s)&&G(e,s,o[s]);return e};var Y=(e,o)=>{var s={};for(var c in e)Q.call(e,c)&&o.indexOf(c)<0&&(s[c]=e[c]);if(e!=null&&R)for(var c of R(e))o.indexOf(c)<0&&X.call(e,c)&&(s[c]=e[c]);return s};var g=(e,o)=>{let s="[react-use-intercom]";switch(e){case "info":console.log(`${s} ${o}`);break;case "warn":console.warn(`${s} ${o}`);break;case "error":console.error(`${s} ${o}`);break;default:console.log(`${s} ${o}`);}};var I=typeof window=="undefined",A=e=>(Object.keys(e).forEach(o=>{e[o]&&typeof e[o]=="object"?A(e[o]):e[o]===void 0&&delete e[o];}),e);var ie=(e,...o)=>{if(!I&&window.Intercom)return window.Intercom.apply(null,[e,...o]);g("error",`${e} Intercom instance is not initalized yet`);},a=ie;var me=n.createContext(void 0),b=me;var le=(e,o=0,s,c)=>{var i=window,p=i.Intercom;if(typeof p=="function")p("reattach_activator"),p("update",i.intercomSettings);else {var h=document,w=function(){w.c(arguments);};w.q=[],w.c=function(m){w.q.push(m);},i.Intercom=w;var d=function(){setTimeout(function(){var m=h.createElement("script");m.type="text/javascript",m.async=true,s&&m.setAttribute("nonce",s),m.src=(c||"https://widget.intercom.io/widget/")+"?appid="+e;var v=h.getElementsByTagName("script")[0];v.parentNode.insertBefore(m,v);},o);};document.readyState==="complete"?d():i.attachEvent?i.attachEvent("onload",d):i.addEventListener("load",d,false);}},ee=le;var ue=e=>({custom_launcher_selector:e.customLauncherSelector,alignment:e.alignment,vertical_padding:e.verticalPadding,horizontal_padding:e.horizontalPadding,z_index:e.zIndex,hide_default_launcher:e.hideDefaultLauncher,session_duration:e.sessionDuration,action_color:e.actionColor,background_color:e.backgroundColor}),te=e=>u({company_id:e.companyId,name:e.name,created_at:e.createdAt,plan:e.plan,monthly_spend:e.monthlySpend,user_count:e.userCount,size:e.size,website:e.website,industry:e.industry},e.customAttributes),de=e=>({type:e.type,image_url:e.imageUrl}),pe=e=>{var o;return u({email:e.email,user_id:e.userId,created_at:e.createdAt,name:e.name,phone:e.phone,last_request_at:e.lastRequestAt,unsubscribed_from_emails:e.unsubscribedFromEmails,language_override:e.languageOverride,utm_campaign:e.utmCampaign,utm_content:e.utmContent,utm_medium:e.utmMedium,utm_source:e.utmSource,utm_term:e.utmTerm,avatar:e.avatar&&de(e.avatar),user_hash:e.userHash,company:e.company&&te(e.company),companies:(o=e.companies)==null?void 0:o.map(te),intercom_user_jwt:e.intercomUserJwt},e.customAttributes)},k=e=>A(u(u({},ue(e)),pe(e)));var we=ge=>{var P=ge,{appId:e,autoBoot:o=false,autoBootProps:s,children:c,onHide:i,onShow:p,onUnreadCountChange:h,onUserEmailSupplied:w,shouldInitialize:d=!I,apiBase:m,initializeDelay:v,cspNonce:re,scriptUrl:ne}=P,ae=Y(P,["appId","autoBoot","autoBootProps","children","onHide","onShow","onUnreadCountChange","onUserEmailSupplied","shouldInitialize","apiBase","initializeDelay","cspNonce","scriptUrl"]);let f=n.useRef(false),_=n.useRef(false),[x,y]=n.useState(false),S=Object.keys(ae).filter(t=>!t.startsWith("data-"));S.length>0&&g("warn",["some invalid props were passed to IntercomProvider. ",`Please check following props: ${S.join(", ")}.`].join(""));let C=n.useCallback(t=>{if(!window.Intercom&&!d){g("warn","Intercom instance is not initialized because `shouldInitialize` is set to `false` in `IntercomProvider`");return}if(f.current)return;a("onHide",()=>{y(false),i==null||i();}),a("onShow",()=>{y(true),p==null||p();}),a("onUserEmailSupplied",w),h&&a("onUnreadCountChange",h);let l=u(u({app_id:e},m&&{api_base:m}),t&&k(t));window.intercomSettings=l,a("boot",l),f.current=true;},[m,e,i,p,h,w,d]);!I&&d&&!_.current&&(ee(e,v,re,ne),o&&C(s),_.current=true);let r=n.useCallback((t,l)=>{if(!window.Intercom&&!d){g("warn","Intercom instance is not initialized because `shouldInitialize` is set to `false` in `IntercomProvider`");return}if(!f.current){g("warn",[`"${t}" was called but Intercom has not booted yet. `,`Please call 'boot' before calling '${t}' or `,"set 'autoBoot' to true in the IntercomProvider."].join(""));return}return l()},[d]),D=n.useCallback(()=>{f.current&&(a("shutdown"),delete window.intercomSettings,f.current=false);},[]),M=n.useCallback(()=>{f.current&&(a("shutdown"),delete window.Intercom,delete window.intercomSettings,f.current=false);},[]),T=n.useCallback(()=>{r("update",()=>{let t=Math.floor(new Date().getTime()/1e3);a("update",{last_request_at:t});});},[r]),E=n.useCallback(t=>{r("update",()=>{if(!t){T();return}let l=k(t);window.intercomSettings=u(u({},window.intercomSettings),l),a("update",l);});},[r,T]),$=n.useCallback(()=>{r("hide",()=>{a("hide");});},[r]),z=n.useCallback(()=>{r("show",()=>a("show"));},[r]),V=n.useCallback(()=>{r("showMessages",()=>{a("showMessages");});},[r]),N=n.useCallback(t=>{r("showNewMessage",()=>{t?a("showNewMessage",t):a("showNewMessage");});},[r]),L=n.useCallback(()=>r("getVisitorId",()=>a("getVisitorId")),[r]),q=n.useCallback(t=>{r("startTour",()=>{a("startTour",t);});},[r]),O=n.useCallback(t=>{r("startChecklist",()=>{a("startChecklist",t);});},[r]),B=n.useCallback((t,l)=>{r("trackEvent",()=>{l?a("trackEvent",t,l):a("trackEvent",t);});},[r]),j=n.useCallback(t=>r("showArticle",()=>{a("showArticle",t);}),[r]),U=n.useCallback(t=>r("showSpace",()=>{a("showSpace",t);}),[r]),F=n.useCallback(t=>{r("startSurvey",()=>{a("startSurvey",t);});},[r]),W=n.useCallback(t=>r("showNews",()=>{a("showNews",t);}),[r]),J=n.useCallback(t=>r("showTicket",()=>{a("showTicket",t);}),[r]),K=n.useCallback(t=>r("showConversation",()=>{a("showConversation",t);}),[r]),se=n.useMemo(()=>({boot:C,shutdown:D,hardShutdown:M,update:E,hide:$,show:z,isOpen:x,showMessages:V,showNewMessage:N,getVisitorId:L,startTour:q,startChecklist:O,trackEvent:B,showArticle:j,startSurvey:F,showSpace:U,showNews:W,showTicket:J,showConversation:K}),[C,D,M,E,$,z,x,V,N,L,q,O,B,j,F,U,W,J,K]);return n.createElement(b.Provider,{value:se},c)},oe=()=>{let e=n.useContext(b);if(e===void 0)throw new Error('"useIntercom" must be used within `IntercomProvider`.');return e};var fe=()=>oe();
export{we as IntercomProvider,fe as useIntercom};//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map